ВЫБРАТЬ
    Данные.Контрагент,
    Контрагенты.Наименование КАК Контрагент,
    СУММА(Данные.КоличествоПриход) КАК КоличествоПоступило,
    СУММА(Данные.КоличествоРасход) КАК КоличествоПродано
ИЗ
(
    ВЫБРАТЬ
        Приход.Поставщик КАК Контрагент,
        СУММА(ТЧПриход.Количество) КАК КоличествоПриход,
        0 КАК КоличествоРасход
    ИЗ
        Документ.ПриобретениеТоваров.ТабличнаяЧасть1 КАК ТЧПриход
            ЛЕВОЕ СОЕДИНЕНИЕ Документ.ПриобретениеТоваров КАК Приход
            ПО ТЧПриход.Ссылка = Приход.Ссылка
    СГРУППИРОВАТЬ ПО
        Приход.Поставщик

    ОБЪЕДИНИТЬ ВСЕ

    ВЫБРАТЬ
        Реализация.Покупатель КАК Контрагент,
        0 КАК КоличествоПриход,
        СУММА(ТЧРасход.Количество) КАК КоличествоРасход
    ИЗ
        Документ.РеализацияТоваров.ТабличнаяЧасть1 КАК ТЧРасход
            ЛЕВОЕ СОЕДИНЕНИЕ Документ.РеализацияТоваров КАК Реализация
            ПО ТЧРасход.Ссылка = Реализация.Ссылка
    СГРУППИРОВАТЬ ПО
        Реализация.Покупатель
) КАК Данные
    ЛЕВОЕ СОЕДИНЕНИЕ Справочник.Контрагенты КАК Контрагенты
    ПО Данные.Контрагент = Контрагенты.Ссылка
СГРУППИРОВАТЬ ПО
    Данные.Контрагент,
    Контрагенты.Наименование
